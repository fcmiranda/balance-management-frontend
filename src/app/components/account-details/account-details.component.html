<div class="container mx-auto p-4">
  @if (loading) {
    <div class="flex justify-center items-center min-h-64">
      <mat-spinner diameter="40"></mat-spinner>
    </div>
  } @else if (error) {
    <mat-card class="error-card">
      <mat-card-content>
        <div class="flex items-center gap-2 text-red-600">
          <mat-icon>error</mat-icon>
          <span>{{ error }}</span>
        </div>
      </mat-card-content>
      <mat-card-actions>
        <button mat-button (click)="onRefresh()" color="primary">
          <mat-icon>refresh</mat-icon>
          Retry
        </button>
        <button mat-button (click)="goBack()">
          <mat-icon>arrow_back</mat-icon>
          Go Back
        </button>
      </mat-card-actions>
    </mat-card>
  } @else if (account) {

    <!-- Account Information -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
      <mat-card>
        <mat-card-header>
          <mat-card-title>Account Information</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="space-y-4">
            <div class="flex justify-between items-center">
              <span class="text-gray-600">Account Number:</span>
              <span class="font-mono">{{ account.accountNumber }}</span>
            </div>
            
            <div class="flex justify-between items-center">
              <span class="text-gray-600">Account Type:</span>
              <span class="capitalize">{{ account.type }}</span>
            </div>
            
            <div class="flex justify-between items-center">
            </div>
            
            <div class="flex justify-between items-center">
              <span class="text-gray-600">Created:</span>
              <span>{{ account.createdAt | date:'medium' }}</span>
            </div>
            
            <div class="flex justify-between items-center">
              <span class="text-gray-600">Last Updated:</span>
              <span>{{ account.updatedAt | date:'medium' }}</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card>
        <mat-card-header>
          <mat-card-title>Balance Information</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="text-center">
            <div class="text-3xl font-bold text-primary mb-2">
              {{ formatCurrency(account.balance) }}
            </div>
            <div class="text-sm text-gray-600">Current Balance</div>
          </div>
          
          <mat-divider class="my-4"></mat-divider>
          
          <div class="grid grid-cols-2 gap-4 text-sm">
            <div class="text-center">
              <div class="font-semibold">Available</div>
              <div class="text-green-600">{{ formatCurrency(account.balance) }}</div>
            </div>
            <div class="text-center">
              <div class="font-semibold">Pending</div>
              <div class="text-yellow-600">{{ formatCurrency(0) }}</div>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Transactions -->
    <mat-card>
      <mat-card-header>
        <mat-card-title>Transaction History</mat-card-title>
        <mat-card-subtitle>Recent account activity</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        @if (transactions.length === 0) {
          <div class="text-center py-8">
            <mat-icon class="text-gray-400 text-4xl mb-2">receipt_long</mat-icon>
            <p class="text-gray-600">No transactions found</p>
          </div>
        } @else {
          <div class="overflow-x-auto">
            <table mat-table [dataSource]="transactions" class="w-full">
              <!-- Date Column -->
              <ng-container matColumnDef="date">
                <th mat-header-cell *matHeaderCellDef>Date</th>
                <td mat-cell *matCellDef="let transaction">
                  {{ transaction.createdAt | date:'shortDate' }}
                </td>
              </ng-container>

              <!-- Type Column -->
              <ng-container matColumnDef="type">
                <th mat-header-cell *matHeaderCellDef>Type</th>
                <td mat-cell *matCellDef="let transaction">
                  <div class="flex items-center gap-2">
                    <mat-icon [class]="getTransactionTypeColor(transaction.type)">
                      {{ transaction.type === 'deposit' ? 'arrow_downward' : 'arrow_upward' }}
                    </mat-icon>
                    <span class="capitalize">{{ transaction.type }}</span>
                  </div>
                </td>
              </ng-container>

              <!-- Amount Column -->
              <ng-container matColumnDef="amount">
                <th mat-header-cell *matHeaderCellDef>Amount</th>
                <td mat-cell *matCellDef="let transaction">
                  <span [class]="getTransactionTypeColor(transaction.type)">
                    {{ transaction.type === 'deposit' ? '+' : '-' }}{{ formatCurrency(transaction.amount) }}
                  </span>
                </td>
              </ng-container>

              <!-- Description Column -->
              <ng-container matColumnDef="description">
                <th mat-header-cell *matHeaderCellDef>Description</th>
                <td mat-cell *matCellDef="let transaction">
                  {{ transaction.description || 'No description' }}
                </td>
              </ng-container>

              <!-- Balance Column -->
              <ng-container matColumnDef="balance">
                <th mat-header-cell *matHeaderCellDef>Balance After</th>
                <td mat-cell *matCellDef="let transaction">
                  {{ formatCurrency(transaction.balanceAfter) }}
                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
          </div>
        }
      </mat-card-content>
    </mat-card>
  }
